<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        #wrap {
            width: 400px;
            height: 300px;
            position: relative;
            border: 5px solid #000;
            margin: 100px auto;
            overflow: hidden;
        }

        #banner {
            width: 700%;
            height: 260px;
            position: absolute;
            left: -400px;
            top: 0;
        }

        #banner>div {
            width: 400px;
            height: 100%;
            font-size: 150px;
            text-align: center;
            /* color:#fff; */
            float: left;
            line-height: 260px;
        }

        #btns {
            width: 100%;
            height: 40px;
            position: absolute;
            bottom: 0;
            left: 0;
            background: #e5e5e5;
        }

        .btn {
            width: 20%;
            height: 100%;
            line-height: 40px;
            text-align: center;
            font-size: 26px;
            color: #fff;
            float: left;
            cursor: pointer;
        }

        #active {
            background: #fff;
            color: #000;
        }
        #nextBtn{
            width: 50px;
            height: 50px;
            border-radius:50%;
            line-height:50px;
            text-align:center;
            position:absolute;
            background: rgba(0,0,0,.4);
            color:#fff;
            right:20px;
            top:calc(50% - 25px);
            cursor: pointer;
        }
        #lastBtn{
            width: 50px;
            height: 50px;
            border-radius:50%;
            line-height:50px;
            text-align:center;
            position:absolute;
            background: rgba(0,0,0,.4);
            color:#fff;
            right:20px;
            top:calc(50% - 25px);
            cursor: pointer;
        }
    </style>
    <script src="tween.js"></script>
</head>

<body>
    <div id="wrap">
        <div id="banner">
                <div style="background:blue">5</div>
            <div style="background:red">1</div>
            <div style="background:orange">2</div>
            <div style="background:yellow">3</div>
            <div style="background:green">4</div>
            <div style="background:blue">5</div>
            <div style="background:red">1</div>
        </div>
        <div id="btns">
            <div class="btn" id="active">1</div>
            <div class="btn">2</div>
            <div class="btn">3</div>
            <div class="btn">4</div>
            <div class="btn">5</div>
        </div>
        <div id="nextBtn">ğŸ‘‰</div>
        <div id="laxtBtn">ğŸ‘ˆ</div>
    </div>
</body>
<script>
    // 1.è·å–å…ƒç´ åŠå®šä¹‰éœ€è¦çš„å˜é‡
    var banner = document.getElementById('banner'),
        nextBtn = document.getElementById('nextBtn'),
        btns = document.getElementsByClassName('btn'),
        w = -400,
        index = 1,//è®°å½•å›¾ç‰‡çš„ä¸‹æ ‡
        timer1 = null,//æ§åˆ¶æ’­æ”¾é—´éš”çš„å®šæ—¶å™¨
        timer2 = null,//æ§åˆ¶è‡ªåŠ¨åˆ‡å›¾çš„å®šæ—¶å™¨
        timer3 = null;//æ§åˆ¶ç‚¹å‡»åˆ‡å›¾çš„å®šæ—¶å™¨
    // 2.å£°æ˜åŠŸèƒ½å‡½æ•°
    // åˆ‡æ¢æŒ‰æ‰­é€‰ä¸­æ ·å¼çš„å‡½æ•°
    function activeFn(n) {
        // æ ·å¼ç½®ç©º
        for (var i = 0; i < btns.length; i++) {
            btns[i].id = '';
        }
        // é€‰ä¸­æ ·å¼
        btns[n].id = 'active';
    }
    // è½®æ’­å‡½æ•°
    function bannerFn() {
        clearInterval(timer1);
        timer1 = setInterval(function () {
            next();
        }, 2000)
    }
    // ä¸‹ä¸€é¡µ
    function next() {
        index++;
        var n = index > 4 ? 0 : index;
        activeFn(n);
        clearInterval(timer2);
        timer2 = setInterval(function () {
            var l = banner.offsetLeft - 10;
            if (l <= index * w) {
                clearInterval(timer2);
                bannerFn();
            }
            if (l == 6 * w) {
                l = -400;
                index = 1;
            }
            banner.style.left = l + 'px';
        }, 20)
    }
    bannerFn();
    // ç‚¹å‡»åˆ‡å›¾çš„å‡½æ•°
    function changeFn(newIndex) {
        clearInterval(timer1);
        clearInterval(timer2);
        clearInterval(timer3);
        // æ›´æ–°å½“å‰å›¾ç‰‡ä¸‹æ ‡
        index = newIndex;
        var t = 0,
            b = banner.offsetLeft,
            c = (newIndex+1) * w - b,
            d = 25;
        timer3 = setInterval(function () {
            t++;
            if (t >= d) {
                clearInterval(timer3);
                bannerFn();//é‡æ–°å¼€å¯è‡ªåŠ¨åˆ‡å›¾
            }
            banner.style.left = Tween.Linear(t, b, c, d) + 'px';
        }, 20)
    }
    // ç»‘å®šäº‹ä»¶
    for (var i = 0; i < btns.length; i++) {
        (function (i) {
            btns[i].onclick = function () {
                activeFn(i);
                changeFn(i);
            }
        })(i)
        // function activeFn(n) {
        //     // æ ·å¼ç½®ç©º
        //     for (vari = 0; i < btns.length; i++) {
        //         btns[i].id = '';
        //     }
        //     // é€‰ä¸­æ ·å¼
        //     btns[n].id = 'active';
        // }
    }
    nextBtn.onclick = function(){
        clearInterval(timer1);
        clearInterval(timer2);
        next();
    }
</script>

</html>